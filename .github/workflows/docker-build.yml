name: 'docker-image'
on:
  push:
    branches:
      - master
    paths:
      - 'Dockers/go-builder/**'
jobs:
  build:
    runs-on: 'ubuntu-20.04'
    steps:
      - uses: actions/checkout@v2

      - name: Define docker image tag
        id: get_image_tag
        run: echo ::set-output name=IMAGE_TAG::${grep 'GOLANG_IMAGE=golang:' Dockers/go-builder/Dockerfile | cut -d ":" -f 2}

      - name: Build and push image
        run: |
          docker build -t ashwatth:${{ steps.get_image_tag.outputs.IMAGE_TAG }} Dockers/go-builder
